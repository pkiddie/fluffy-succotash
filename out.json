[{"number":1,"state":"open","dependency":{"package":{"ecosystem":"npm","name":"express"},"manifest_path":"package-lock.json","scope":"runtime"},"security_advisory":{"ghsa_id":"GHSA-rv95-896h-c2vc","cve_id":"CVE-2024-29041","summary":"Express.js Open Redirect in malformed URLs","description":"### Impact\n\nVersions of Express.js prior to 4.19.2 and pre-release alpha and beta versions before 5.0.0-beta.3 are affected by an open redirect vulnerability using malformed URLs.\n\nWhen a user of Express performs a redirect using a user-provided URL Express performs an encode [using `encodeurl`](https://github.com/pillarjs/encodeurl) on the contents before passing it to the `location` header. This can cause malformed URLs to be evaluated in unexpected ways by common redirect allow list implementations in Express applications, leading to an Open Redirect via bypass of a properly implemented allow list.\n\nThe main method impacted is `res.location()` but this is also called from within `res.redirect()`.\n\n### Patches\n\nhttps://github.com/expressjs/express/commit/0867302ddbde0e9463d0564fea5861feb708c2dd\nhttps://github.com/expressjs/express/commit/0b746953c4bd8e377123527db11f9cd866e39f94\n\nAn initial fix went out with `express@4.19.0`, we then patched a feature regression in `4.19.1` and added improved handling for the bypass in `4.19.2`.\n\n### Workarounds\n\nThe fix for this involves pre-parsing the url string with either `require('node:url').parse` or `new URL`. These are steps you can take on your own before passing the user input string to `res.location` or `res.redirect`.\n\n### References\n\nhttps://github.com/expressjs/express/pull/5539\nhttps://github.com/koajs/koa/issues/1800\nhttps://expressjs.com/en/4x/api.html#res.location","severity":"medium","identifiers":[{"value":"GHSA-rv95-896h-c2vc","type":"GHSA"},{"value":"CVE-2024-29041","type":"CVE"}],"references":[{"url":"https://github.com/expressjs/express/security/advisories/GHSA-rv95-896h-c2vc"},{"url":"https://github.com/koajs/koa/issues/1800"},{"url":"https://github.com/expressjs/express/pull/5539"},{"url":"https://github.com/expressjs/express/commit/0867302ddbde0e9463d0564fea5861feb708c2dd"},{"url":"https://github.com/expressjs/express/commit/0b746953c4bd8e377123527db11f9cd866e39f94"},{"url":"https://expressjs.com/en/4x/api.html#res.location"},{"url":"https://nvd.nist.gov/vuln/detail/CVE-2024-29041"},{"url":"https://github.com/advisories/GHSA-rv95-896h-c2vc"}],"published_at":"2024-03-25T19:40:26Z","updated_at":"2024-03-27T21:47:29Z","withdrawn_at":null,"vulnerabilities":[{"package":{"ecosystem":"npm","name":"express"},"severity":"medium","vulnerable_version_range":"< 4.19.2","first_patched_version":{"identifier":"4.19.2"}},{"package":{"ecosystem":"npm","name":"express"},"severity":"medium","vulnerable_version_range":">= 5.0.0-alpha.1, < 5.0.0-beta.3","first_patched_version":{"identifier":"5.0.0-beta.3"}}],"cvss":{"vector_string":"CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N","score":6.1},"cwes":[{"cwe_id":"CWE-601","name":"URL Redirection to Untrusted Site ('Open Redirect')"},{"cwe_id":"CWE-1286","name":"Improper Validation of Syntactic Correctness of Input"}]},"security_vulnerability":{"package":{"ecosystem":"npm","name":"express"},"severity":"medium","vulnerable_version_range":"< 4.19.2","first_patched_version":{"identifier":"4.19.2"}},"url":"https://api.github.com/repos/pkiddie/fluffy-succotash/dependabot/alerts/1","html_url":"https://github.com/pkiddie/fluffy-succotash/security/dependabot/1","created_at":"2024-04-16T09:16:31Z","updated_at":"2024-04-16T09:16:31Z","dismissed_at":null,"dismissed_by":null,"dismissed_reason":null,"dismissed_comment":null,"fixed_at":null,"auto_dismissed_at":null}]